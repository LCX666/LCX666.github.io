<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Windows 使用 lxrunoffline 安装 WSL、WSL2 | Ron&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="利用 lxrunoffline 完成 WSL 的安装，可安装到任意位置，也可备份和迁移。">
<meta property="og:type" content="article">
<meta property="og:title" content="Windows 使用 lxrunoffline 安装 WSL、WSL2">
<meta property="og:url" content="https://lucxer.tk/2020/12/28/WSL2%E5%AE%89%E8%A3%85/index.html">
<meta property="og:site_name" content="Ron&#39;s Blog">
<meta property="og:description" content="利用 lxrunoffline 完成 WSL 的安装，可安装到任意位置，也可备份和迁移。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228193934870.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228193955261.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228194013308.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228194919061.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228194824800.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228195057696.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228203158530.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201229140249702.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228210417296.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228211448330.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228232704365.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201229144215709.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201229144254301.png">
<meta property="og:image" content="c:/Users/chegn/AppData/Roaming/Typora/typora-user-images/image-20201228234022577.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201229145235756.png">
<meta property="og:image" content="https://raw.githubusercontent.com/LCX666/picgo-blog/master/img/image-20201228215355213.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228215451721.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201229133649835.png">
<meta property="article:published_time" content="2020-12-28T10:33:52.000Z">
<meta property="article:modified_time" content="2020-12-29T13:24:54.777Z">
<meta property="article:author" content="Ron">
<meta property="article:tag" content="WSL">
<meta property="article:tag" content="WSL2">
<meta property="article:tag" content="配置">
<meta property="article:tag" content="Windows">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228193934870.png">
  
    <link rel="alternate" href="/atom.xml" title="Ron's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Ron&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">淡泊明志, 宁静致远</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://lucxer.tk"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-WSL2安装" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/28/WSL2%E5%AE%89%E8%A3%85/" class="article-date">
  <time class="dt-published" datetime="2020-12-28T10:33:52.000Z" itemprop="datePublished">2020-12-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/">环境配置</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Windows 使用 lxrunoffline 安装 WSL、WSL2
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="0x01-写在前面"><a href="#0x01-写在前面" class="headerlink" title="0x01 写在前面"></a>0x01 写在前面</h1><p>笔者认为似乎应该在前面写点什么，但是又不知道写点什么，于是就写了这段话。或许笔者正在思考怎么写这段话。</p>
<p>关于 <code>WSL</code> 有什么好，或者有什么比较方便的地方，这里不多赘述。</p>
<p><strong>多图预警。</strong></p>
<br>

<h1 id="0x02-官方教程配置环境"><a href="#0x02-官方教程配置环境" class="headerlink" title="0x02 官方教程配置环境"></a>0x02 官方教程配置环境</h1><h2 id="2-1-加入体验计划"><a href="#2-1-加入体验计划" class="headerlink" title="2.1 加入体验计划"></a>2.1 加入体验计划</h2><p>首先进入 <code>设置</code> → <code>更新和安全</code> → <code>Windows预览体验计划</code> 然后选择开始，加入此计划。然后选择 <code>Dev</code> ，然后一路默认。</p>
<blockquote>
<p>如果点进来是一片空白，根据<a target="_blank" rel="noopener" href="https://answers.microsoft.com/zh-hans/insider/forum/insider_wintp-insider_install/windows%E9%A2%84%E8%A7%88%E4%BD%93%E9%AA%8C/14d3002b-03ac-459e-b518-34231b1727e0?auth=1">官方</a>提示，需要修改一个地方：</p>
<p>在设置中搜索 <code>诊断数据</code>，打开 <code>诊断和数据</code>，修改为 <code>可选诊断数据</code> 即可出现上述的界面，而不是白的了。可参考。</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228193934870.png" alt="Windows预览体验计划"></p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228193955261.png" alt="Windows预览体验计划2"></p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228194013308.png" alt="Windows预览体验计划3"></p>
<br>

<h3 id="2-1-2-更新系统版本"><a href="#2-1-2-更新系统版本" class="headerlink" title="2.1.2 更新系统版本"></a>2.1.2 更新系统版本</h3><p>重启之后，进入设置中的 <code>Windows 更新</code>，在下图所示的 <code>高级选项</code> 中选择 <code>更新 Windows 时接受其他 Microsoft 产品更新</code>。</p>
<p>然后返回更新页面，开始进行更新，这个过程可能会反复很多次，耗时也比较久。</p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228194919061.png" alt="高级选项"></p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228194824800.png" alt="检测到更新"></p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228195057696.png" alt="开始下载更新"></p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228203158530.png" alt="等待重启更新"></p>
<br>

<h3 id="2-1-3-检查系统版本"><a href="#2-1-3-检查系统版本" class="headerlink" title="2.1.3 检查系统版本"></a>2.1.3 检查系统版本</h3><p>更新完毕后，需要检查当前的系统版本是否满足要求了。 按住 <code>win</code> + <code>R</code> 输入命令：<code>winver</code> ，即可以查看下图的信息。</p>
<p>WSL要求系统版本 2004 以上，微软官方说 OS 内部版本为 19041 以上。</p>
<p>而想要安装 CUDA，则要求系统不仅仅是版本 2004， 并且 OS 内部版本必须为 20145 之后。</p>
<p><strong>所以，读者根据自己的需求自行决定。</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201229140249702.png" alt="系统信息"></p>
<br>

<h3 id="2-1-4-打开-WSL-选项"><a href="#2-1-4-打开-WSL-选项" class="headerlink" title="2.1.4 打开 WSL 选项"></a>2.1.4 打开 WSL 选项</h3><h4 id="2-1-4-1-命令行打开-WSL"><a href="#2-1-4-1-命令行打开-WSL" class="headerlink" title="2.1.4.1 命令行打开 WSL"></a>2.1.4.1 命令行打开 WSL</h4><p>以管理员权限运行 <code>PowerShell</code> 并输入下面的命令，若提示是否要重启，则选择暂时不重启。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux</span><br><span class="line"></span><br><span class="line">dism.exe &#x2F;online &#x2F;enable-feature &#x2F;featurename:Microsoft-Windows-Subsystem-Linux &#x2F;all &#x2F;norestart</span><br></pre></td></tr></table></figure>
<p>两个命令都运行完毕后，手动重启。</p>
<h4 id="2-1-4-2-检查启动是否成功"><a href="#2-1-4-2-检查启动是否成功" class="headerlink" title="2.1.4.2 检查启动是否成功"></a>2.1.4.2 检查启动是否成功</h4><p>重启之后，在 <code>控制面板</code> → <code>程序</code> → <code>启动或关闭Windows功能</code> 检查是否开启了 <code>适用于Linux的Windows子系统</code>。（有可能是英文</p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228210417296.png" alt="检查WSL启动成功"></p>
<p>确认开启无误后，在管理员 <code>PowerShell</code> 中运行下面命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dism.exe &#x2F;online &#x2F;enable-feature &#x2F;featurename:VirtualMachinePlatform &#x2F;all &#x2F;norestart</span><br></pre></td></tr></table></figure>
<p>然后重启。</p>
<br>

<h3 id="2-1-5-下载-msi-安装包"><a href="#2-1-5-下载-msi-安装包" class="headerlink" title="2.1.5 下载 msi 安装包"></a>2.1.5 下载 msi 安装包</h3><p>从官方下载对应的安装包文件，然后直接一瞬安装。唯一需要注意的就是自己系统的版本和CPU架构。</p>
<p>msi 安装包地址：<a target="_blank" rel="noopener" href="https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi">download</a>。</p>
<p>然后双击运行</p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228211448330.png" alt="进行安装"></p>
<p>一路默认就好</p>
<br>

<h3 id="2-1-6-设置默认-WSL2"><a href="#2-1-6-设置默认-WSL2" class="headerlink" title="2.1.6 设置默认 WSL2"></a>2.1.6 设置默认 WSL2</h3><p>然后在管理员 <code>PowerShell</code> 中通过如下命令设置默认版本为 <code>WSL2</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --set-default-version 2</span><br></pre></td></tr></table></figure>
<br>

<h2 id="2-2-lxrunoffline-工具安装"><a href="#2-2-lxrunoffline-工具安装" class="headerlink" title="2.2 lxrunoffline  工具安装"></a>2.2 lxrunoffline  工具安装</h2><p>下面将使用工具 <code>lxrunoffline </code> 进行后续的安装，若读者只想从官方一样用微软商店进行安装的话，移步<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/wsl/install-win10#step-5---set-wsl-2-as-your-default-version">官方教程</a>，后面就比较简单。 </p>
<h3 id="2-2-1-lxrunoffline-简介"><a href="#2-2-1-lxrunoffline-简介" class="headerlink" title="2.2.1 lxrunoffline  简介"></a>2.2.1 lxrunoffline  简介</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/DDoSolitary/LxRunOffline">lxrunoffline</a> 工具是一个 GitHub 上开发的很好用的管理工具，使用这个工具具有众多好处：</p>
<p>可以安装任意发行版到任意目录、转移已安装的 WSL 目录、备份 WSL、设置默认用户和修改环境变量等操作，完全碾压 WSL、wslconfig 这些简陋原生管理命令。</p>
</blockquote>
<br>

<h3 id="2-2-2-lxrunoffline-的安装"><a href="#2-2-2-lxrunoffline-的安装" class="headerlink" title="2.2.2 lxrunoffline 的安装"></a>2.2.2 lxrunoffline 的安装</h3><p>虽然 <code>lxrunoffline</code> 从笔者看的博文来看拥有多重安装方式，但是个人觉得其他的方式需要额外配置很多环境或者工具。不如直接手动安装来得好和轻便。</p>
<blockquote>
<p>  其他方式有如 使用 Chocolatey 安装， 使用 Scoop 安装。这部分读者有兴趣可以参阅这个<a target="_blank" rel="noopener" href="https://p3terx.com/archives/manage-wsl-with-lxrunoffline.html">博文</a>。</p>
</blockquote>
<h4 id="2-2-2-1-下载-lxrunoffline"><a href="#2-2-2-1-下载-lxrunoffline" class="headerlink" title="2.2.2.1 下载 lxrunoffline"></a>2.2.2.1 下载 lxrunoffline</h4><p>首先是下载 <code>lxrunoffline</code>，<a target="_blank" rel="noopener" href="https://github.com/DDoSolitary/LxRunOffline/releases">地址</a>。</p>
<p>然后选择合适的版本，我也不知道区别，只是我认识 mingw 所以就选择了这个。下载解压之后里面有个 <code>LxRunOffline.exe</code>，然后将 <code>LxRunOffline.exe</code> 放到某一个你觉得合适的地方，然后为了方便，建议添加环境变量。</p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228232704365.png" alt="下载lxrunoffline"></p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201229144215709.png" alt="添加lxrunoffline到环境变量"></p>
<p>然后就可以愉快在命令行中使用这个命令了 <code>lxrunoffline</code> 。</p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201229144254301.png" alt="lxrunoffline 命令"></p>
<p>至此 <code>lxrunoffline </code> 安装完毕。</p>
<h4 id="2-2-2-2-lxrunoffline-命令介绍"><a href="#2-2-2-2-lxrunoffline-命令介绍" class="headerlink" title="2.2.2.2 lxrunoffline 命令介绍"></a>2.2.2.2 lxrunoffline 命令介绍</h4><p>细心的读者已经发现上图中已经显示了一种查看help的方式，直接缺省就会打印help信息，这里简要列举了部分。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">l , list - 列出所有已安装的发行版。</span><br><span class="line">gd , get-default - 获取 bash.exe 使用的默认发行版。</span><br><span class="line">sd , set-default - 设置 bash.exe 使用的默认发行版。</span><br><span class="line">i , install - 安装新的发行版。</span><br><span class="line">sd , set-default - 设置 bash.exe 使用的默认发行版。</span><br><span class="line">ui , uninstall - 卸载发行版。</span><br><span class="line">rg , register - 注册现有的安装目录。</span><br><span class="line">ur , unregister - 取消注册发行版但不删除安装目录。</span><br><span class="line">m , move - 将发行版移动到新目录。</span><br><span class="line">d , duplicate - 在新目录中复制现有发行版。</span><br><span class="line">e , export - 将发行版的文件系统导出到.tar.gz 文件，该文件可以通过 install 命令安装。</span><br><span class="line">r , run - 在发行版中运行命令。</span><br><span class="line">di , get-dir - 获取发行版的安装目录。</span><br><span class="line">gv , get-version - 获取发行版的文件系统版本。</span><br><span class="line">ge , get-env - 获取发行版的默认环境变量。</span><br><span class="line">se , set-env - 设置发行版的默认环境变量。</span><br><span class="line">ae , add-env - 添加到发行版的默认环境变量。</span><br><span class="line">re , remove-env - 从发行版的默认环境变量中删除。</span><br><span class="line">gu , get-uid - 获取发行版的默认用户的 UID。</span><br><span class="line">su , set-uid - 设置发行版的默认用户的 UID。</span><br><span class="line">gk , get-kernelcmd - 获取发行版的默认内核命令行。</span><br><span class="line">sk , set-kernelcmd - 设置发行版的默认内核命令行。</span><br><span class="line">gf , get-flags - 获取发行版的一些标志。有关详细信息，请参考这里。</span><br><span class="line">sf , set-flags - 设置发行版的一些标志。有关详细信息，请参考这里。</span><br><span class="line">s , shortcut - 创建启动发行版的快捷方式。</span><br><span class="line">ec , export-config - 将发行版配置导出到 XML 文件。</span><br><span class="line">ic , import-config - 从 XML 文件导入发行版的配置。</span><br><span class="line">sm , summary - 获取发行版的一般信息。</span><br></pre></td></tr></table></figure>
<p>更多使用功能和常用功能请参阅<a target="_blank" rel="noopener" href="https://p3terx.com/archives/manage-wsl-with-lxrunoffline.html">这里</a>。</p>
<br>

<h2 id="2-3-发行版的安装"><a href="#2-3-发行版的安装" class="headerlink" title="2.3  发行版的安装"></a>2.3  发行版的安装</h2><h3 id="2-3-1-distros-下载"><a href="#2-3-1-distros-下载" class="headerlink" title="2.3.1 distros 下载"></a>2.3.1 distros 下载</h3><p>使用此工具可以按照任意版本的有效的 WSL 发行版本。这里我选择了 <code>Ubuntu18.04</code> ，本来选择 <code>kali</code> 的，但是 <code>kali </code> 安装失败了。于是还是就使用 <code>Ubuntu</code> 了。</p>
<p>官方发行版文件列表在<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/wsl/install-manual#installing-your-distro">这里</a>。点击选择一个合适的版本，这里笔者选择了 <code>Ubuntu18.04</code> 。<code>ARM</code> 架构的朋友自己选择对应的版本。</p>
<p><img src="C:\Users\chegn\AppData\Roaming\Typora\typora-user-images\image-20201228234022577.png" alt="下载列表"></p>
<br>

<h3 id="2-3-2-解压安装"><a href="#2-3-2-解压安装" class="headerlink" title="2.3.2 解压安装"></a>2.3.2 解压安装</h3><p>下载的压缩包解压之后里面有一个 <code>install.tar.gz</code> ，然后就可以安装了。</p>
<blockquote>
<p>为了避免不必要的麻烦，以下都是管理员权限在运行命令</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201229145235756.png" alt="压缩包内容"></p>
<p>先在你想存储此 <code>WSL</code> 的地方建立合适的文件夹。因为笔者有多个不同版本的 <code>WSL</code> ，为了方便在E盘下建立了一个目录 <code>WSL</code>，然后建立了一个文件夹 <code>Ubuntu18CUDA</code> 用于存储此 <code>Ubuntu18.04</code> 的发行版。</p>
<p>上述准备完毕后，然后在 <code>PowerShell</code> 中运行下面的命令，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># lxrunoffline i -n &lt;WSL名称&gt; -d &lt;安装路径&gt; -f &lt;安装包路径&gt;install.tar.gz</span><br><span class="line"></span><br><span class="line">lxrunoffline i -n &quot;Ubuntu18CUDA&quot; -d &quot;G:\WSL\Ubuntu18CUDA&quot; -f &quot;C:\Users\chegn\Downloads\Compressed\Ubuntu_1804.2019.522.0_x64\install.tar.gz&quot;</span><br></pre></td></tr></table></figure>
<p>如下图所示：</p>
<p><img src="https://raw.githubusercontent.com/LCX666/picgo-blog/master/img/image-20201228215355213.png" alt="安装发行版"></p>
<br>

<h3 id="2-3-3-设置用户"><a href="#2-3-3-设置用户" class="headerlink" title="2.3.3 设置用户"></a>2.3.3 设置用户</h3><p>为了方便我们需要设置用户，笔者个人比较喜欢随时都是 <code>root</code>，但是这个不怎安全。</p>
<h4 id="2-3-3-1-设置-root-为默认用户"><a href="#2-3-3-1-设置-root-为默认用户" class="headerlink" title="2.3.3.1 设置 root 为默认用户"></a>2.3.3.1 设置 root 为默认用户</h4><p><code>root</code>  用户的 <code>UID</code> 为 <code>0</code>，所以可以直接在 <code>Pow­er­Shell</code> 输入以下命令进行设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxrunoffline su -n &lt;WSL名称&gt; -v 0</span><br></pre></td></tr></table></figure>
<p>设置默认用户为 <code>root</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201228215451721.png" alt="设置默认用户 root"></p>
<h4 id="2-3-3-2-设置普通用户为默认用户"><a href="#2-3-3-2-设置普通用户为默认用户" class="headerlink" title="2.3.3.2 设置普通用户为默认用户"></a>2.3.3.2 设置普通用户为默认用户</h4><p>使用 <code>lxrunoffline</code> 新安装的 <code>WSL</code> 默认是以 <code>root</code> 用户登录，如果你需要默认以普通用户进行登录，就需要进行下面的操作。</p>
<p>首先运行 <code>WSL </code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxrunoffline r -n &lt;WSL名称&gt;</span><br></pre></td></tr></table></figure>
<p>输入以下命令创建用户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -m -s &#x2F;bin&#x2F;bash &lt;用户名&gt;</span><br></pre></td></tr></table></figure>
<p>然后对该用户设置密码，输入命令后会提示输入两次密码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd &lt;用户名&gt;</span><br></pre></td></tr></table></figure>
<p>授予该用户 <code>sudo</code> 权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod -aG sudo &lt;用户名&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>为了保持和微软商店安装的效果一致，这里提及的方法是把用户添加到 sudo 用户组。其他关于 sudo 权限的设置方法以及免密设置可参考《<a target="_blank" rel="noopener" href="https://p3terx.com/archives/linux-grants-normal-user-sudo-permission.html">Linux 中授予普通用户 sudo 权限的正确方法</a>》这篇文章。</p>
</blockquote>
<p>查看用户 UID ，一般是 <code>1000</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id -u &lt;用户名&gt;</span><br></pre></td></tr></table></figure>
<p>按 <code>Ctrl</code>+<code>D</code> 退出 <code>WSL</code> ，在 <code>Pow­er­Shell</code> 中输入以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxrunoffline su -n &lt;WSL名称&gt; -v 1000</span><br></pre></td></tr></table></figure>
<br>

<h2 id="2-4-进入验证"><a href="#2-4-进入验证" class="headerlink" title="2.4 进入验证"></a>2.4 进入验证</h2><p>通过下面命令，可以启动一个指定的发行版</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxrunoffline r -n &lt;WSL名称&gt;</span><br></pre></td></tr></table></figure>
<p>然后一瞬进入，由于笔者设置了就是管理员root，所以不用sudo。</p>
<p><img src="https://cdn.jsdelivr.net/gh/LCX666/picgo-blog/img/image-20201229133649835.png" alt="测试"></p>
<p>于是到这里 <code>WSL</code> 就安装完毕啦，你可以拿去玩好玩的了。</p>
<br>

<h2 id="2-5-桌面安装"><a href="#2-5-桌面安装" class="headerlink" title="2.5 桌面安装"></a>2.5 桌面安装</h2><p>根据参考的教程，还可以在 <code>WSL</code> 中安装远程桌面，通过 Windows 的远程桌面进行连接，Windows 不需要再安装其他东西。还是挺香的。</p>
<p>使用了xrdp+xface4，参考链接为：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Lz4y1975a">here</a>。</p>
<p>笔者暂时没有这个需求，就没有整。</p>
<br>

<h1 id="0x03-遇到的坑"><a href="#0x03-遇到的坑" class="headerlink" title="0x03 遇到的坑"></a>0x03 遇到的坑</h1><p>使用此方法搭建可能会遇到一个坑：lxrunoffline 可能没认识 <code>WSL2</code> 所以设置的 <code>WSL2</code> 默认版本可能就没有生效，按照的版本就是 <code>WSL1</code> 的，所以如果某些要求2的版本（如对 <code>CUDA</code> 的支持）则需要先将其升级为 <code>WSL2</code> 的才可以。</p>
<p>这里部分请参考另外一篇。</p>
<br>

<h1 id="0x04-总结"><a href="#0x04-总结" class="headerlink" title="0x04 总结"></a>0x04 总结</h1><p>东西确实不错，比虚拟机启动快，随时可以切换，文件系统和Windows共享，可以随便迁移，也可以开启桌面通过远程桌面进行连接，可以保存快照，<code>WSL2</code> 还可以使用 <code>CUDA</code> 了。我想除了某些神奇病毒的研究需要使用虚拟机以进行隔离意外，我暂时想不到不用 <code>WSL</code> 的地方了。</p>
<p>总之，我局的很不错。</p>
<br>

<h1 id="0x05-参考"><a href="#0x05-参考" class="headerlink" title="0x05 参考"></a>0x05 参考</h1><p>lxrunoffline+wsl: <a target="_blank" rel="noopener" href="https://p3terx.com/archives/manage-wsl-with-lxrunoffline.html">https://p3terx.com/archives/manage-wsl-with-lxrunoffline.html</a></p>
<p>wsl2 官方教程: <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">https://docs.microsoft.com/en-us/windows/wsl/install-win10</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://lucxer.tk/2020/12/28/WSL2%E5%AE%89%E8%A3%85/" data-id="ckja3vkpi000114lnb4e78sh1" data-title="Windows 使用 lxrunoffline 安装 WSL、WSL2" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WSL/" rel="tag">WSL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WSL2/" rel="tag">WSL2</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%85%8D%E7%BD%AE/" rel="tag">配置</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/12/29/WSL+CUDA/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          Windows 下利用 WSL2 配置 CUDA和pyCUDA
        
      </div>
    </a>
  
  
    <a href="/2020/11/27/ubuntu_opencv_face_reconginition/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">opcv + face_recognition 实现人脸实时识别</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E9%A1%B9/">杂项</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/">环境配置</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BB%83%E4%B9%A0/">练习</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CUDA/" rel="tag">CUDA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MiKTeX/" rel="tag">MiKTeX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PWN/" rel="tag">PWN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Q-A/" rel="tag">Q&A</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL%E6%B3%A8%E5%85%A5/" rel="tag">SQL注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WSL/" rel="tag">WSL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WSL2/" rel="tag">WSL2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XSS%E6%94%BB%E5%87%BB/" rel="tag">XSS攻击</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/" rel="tag">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/face-recognition/" rel="tag">face recognition</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/latex/" rel="tag">latex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/opencv/" rel="tag">opencv</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pycuda/" rel="tag">pycuda</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tips/" rel="tag">tips</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zeit/" rel="tag">zeit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" rel="tag">人工智能</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/" rel="tag">人脸识别</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E9%A1%B9/" rel="tag">杂项</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%88%E6%BA%A2%E5%87%BA/" rel="tag">栈溢出</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" rel="tag">深度学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%85%8D%E7%BD%AE/" rel="tag">配置</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 16.67px;">CTF</a> <a href="/tags/CUDA/" style="font-size: 10px;">CUDA</a> <a href="/tags/Crypto/" style="font-size: 10px;">Crypto</a> <a href="/tags/Linux/" style="font-size: 13.33px;">Linux</a> <a href="/tags/MiKTeX/" style="font-size: 10px;">MiKTeX</a> <a href="/tags/PWN/" style="font-size: 10px;">PWN</a> <a href="/tags/Q-A/" style="font-size: 10px;">Q&A</a> <a href="/tags/SQL%E6%B3%A8%E5%85%A5/" style="font-size: 10px;">SQL注入</a> <a href="/tags/WSL/" style="font-size: 13.33px;">WSL</a> <a href="/tags/WSL2/" style="font-size: 10px;">WSL2</a> <a href="/tags/Windows/" style="font-size: 16.67px;">Windows</a> <a href="/tags/XSS%E6%94%BB%E5%87%BB/" style="font-size: 10px;">XSS攻击</a> <a href="/tags/blog/" style="font-size: 10px;">blog</a> <a href="/tags/face-recognition/" style="font-size: 10px;">face recognition</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/latex/" style="font-size: 10px;">latex</a> <a href="/tags/opencv/" style="font-size: 10px;">opencv</a> <a href="/tags/pycuda/" style="font-size: 10px;">pycuda</a> <a href="/tags/tips/" style="font-size: 10px;">tips</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/wp/" style="font-size: 10px;">wp</a> <a href="/tags/zeit/" style="font-size: 10px;">zeit</a> <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" style="font-size: 10px;">人工智能</a> <a href="/tags/%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/" style="font-size: 10px;">人脸识别</a> <a href="/tags/%E6%9D%82%E9%A1%B9/" style="font-size: 10px;">杂项</a> <a href="/tags/%E6%A0%88%E6%BA%A2%E5%87%BA/" style="font-size: 10px;">栈溢出</a> <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 10px;">深度学习</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 13.33px;">笔记</a> <a href="/tags/%E9%85%8D%E7%BD%AE/" style="font-size: 20px;">配置</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/12/29/test/">test</a>
          </li>
        
          <li>
            <a href="/2020/12/29/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2020/12/29/WSL+CUDA/">Windows 下利用 WSL2 配置 CUDA和pyCUDA</a>
          </li>
        
          <li>
            <a href="/2020/12/28/WSL2%E5%AE%89%E8%A3%85/">Windows 使用 lxrunoffline 安装 WSL、WSL2</a>
          </li>
        
          <li>
            <a href="/2020/11/27/ubuntu_opencv_face_reconginition/">opcv + face_recognition 实现人脸实时识别</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2020 Ron<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>